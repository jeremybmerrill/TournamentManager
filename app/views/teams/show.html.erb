<p id="notice"><%= notice %></p>

<h1><%= @team.school %> <%= @team.teamabcd %> </h1>

<p>
  <span class="identifier" id="id">Amtaid:</span>
  <%= @team.amtaid %>
</p>

<p>
  <span class="identifier" id="email">Contact Email:</span>
  <%= @team.contactemail %>
</p>

<p>
  <span class="identifier" id="phone">Contact Phone:</span>
  <%= @team.contactphone %>
</p>
<p>
  <span class="identifier" id="upcoming_tournaments">Upcoming Tournaments</span>
  <% @tournaments = @team.tournaments %>
  <% @tournaments.each do |tournament| %>
    <% if tournament.start_date >= Date.today #TODO: make this actually aware of dates.%> 
      <li>
      <%= link_to (tournament) do %>
        <%= tournament.title%>
      <% end %>
        &nbsp;on <%= tournament.start_date.inspect %>
      </li>
    <% end %>
  <% end %>
  
</p>
<p>
    <span class="identifier" id="competitors">Competitors</span>
        <table>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Team Name</th>
            <th></th>
            <th></th>
          </tr>
    <% #FIXME use a partial to render these, later %>
        <% @team.competitors.each do |competitor| %>
          <tr>
            <td><%= link_to (competitor) do %>
              <%= competitor.name %>
              <%  end 
              %>
            </td>
            <td><%= competitor.contactemail %></td>
            <td><%= competitor.contactphone %></td>
            <% begin %>
                <% @team = Team.find(competitor.team_id) %>
                <td><%= @team.school + " " + @team.teamabcd %></td>
            <% rescue %>
                <%= puts "error" %>
            <% end %>
            <td></td>
            <% #TODO: Auth: if logged in as a couch. %>
            <td><%= link_to 'Edit', edit_competitor_path(competitor) %></td>
            <td><%= link_to 'Destroy', competitor, :confirm => 'Are you sure?', :method => :delete %></td>
          </tr>
        <% end %>
        <tr>
            <td id="new_competitor"><%= link_to 'New Competitor', new_competitor_path( :team_id => @team.id) %></td>
        </tr>
        </table>
</p>
<p>
  <span class="identifier" id="past_tournaments">Past Tournaments:</span>
  <% @team.tournament_ids.each do |id| %>
    <% @tournament = Tournament.find(id) %>
    <% if @tournament.start_date < Date.today #TODO: make this actually aware of dates.%> 
      <li>
      <%= link_to (@tournament) do %>
        <%= @tournament.title %>
      <% end %>
        on <%= @tournament.start_date.inspect %>
      </li>
    <% end %>
  <% end %>
</p>

<%= link_to 'Edit', edit_team_path(@team) %> |
<%= link_to 'Back', teams_path %>
